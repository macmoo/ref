<!DOCTYPE html>
<head>
    <meta charset="UTF-8" />
</head>
<body>
    <!-- HTML Tag -->
    
    <!-- Script -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        // --------------------------------------------------------------
        // JS는 var가 없는 변수는 모두 글로벌변수로 취급
        // 로컬변수는 var가 필수
        // [주의] 연쇄대입의 경우
        // var x = z = 100;
        // '='가 우결합이기때문에 z = 100이 먼저 처리되고 암묵적으로 글로벌변수로 처리됨
        // x는 지역변수
        // --------------------------------------------------------------
        // [주의] JS에는 블록스코프가 없다. 블록이 끝나도 변수를 참조가능.
        // --------------------------------------------------------------
        if(true){
            var x  = 100;
        }
        console.log(x); // 100
        // --------------------------------------------------------------
        // 로컬변수 scope는 함수전체에서 유효하지만 값은 아직 대입되지않음.
        // 그렇다고 글로벌변수 scope를 참조하지는 않음(Hoisting)
        // --------------------------------------------------------------
        var scope = 'Global';
        function show(){
            console.log(scope); // undefined
            var scope = 'Local';
            return scope;
        }
        show();
        // --------------------------------------------------------------
        // 즉시함수 : 모든 변수를 로컬스코프에 두고 싶은 경우사용
        // 동작모드 
        // 1. 표준모드 : 에서 this는 글로벌오브젝트(브라우저환경에서는 window오브젝트)를 가리킴
        // 2. strict모드 : 에서는 undefined가 된다.
        // call메소드는 건네받은 오브젝트를 this로 함수를 호출한다.
        // --------------------------------------------------------------
        (function(){ // 익명함수
            var data = 108;
            console.log(data); // 108
        }).call(this); // 그자리에서 즉시 실행
        // console.log(data); // 에러
        // --------------------------------------------------------------
        // 클래스
        // 생성자함수를 정의할 때 주의할점
        // 1. 이름은 대문자로 시작
        // 2. 프로퍼니는 'this.프로퍼티명'으로 정의
        //    생성자내에서 this는 생성된 인스턴스를 가리킴
        // 3. 메소드는 함수형프로퍼티
        //    JS에는 엄밀히 메소드가 없다.
        //    값이 함수오브젝트인 프로퍼티가 메소드로 동작하는 것.
        //    메소드를 생성자에서 정의하는 것은 효율적으로 좋치않다.
        // 4. 리턴값은 불필요
        // --------------------------------------------------------------
        // 문맥(호출한 장소)에 따른 this값의 변화
        // No.--문맥----------- -this값----------------------------------
        //  1.  함수             글로벌오브젝트(strict모드에서는 undefined)
        //  2.  call/apply       인수에서 지정한 오브젝트
        //  3.  이벤트리스터      이벤트발생원
        //  4.  생성자           생성한 인스턴스
        //  5.  메소드           호출원의 오브젝트(=리시버)
        // --------------------------------------------------------------
        // Animal클래스 작성
        // new연산자로 Animal클래스의 인스턴스를 생성`
        var Animal = function(name){
            this.name = name;
            this.toString = function(){
                return 'Animal:' + this.name;
            };
        };
        var ani = new Animal('뽀삐');
        console.log(ani.name);
        console.log(ani.toString());
        // --------------------------------------------------------------
        // [NG] 생성자 강제호출
        // --------------------------------------------------------------
        var ani = Animal('멍멍이');
        console.log(ani);      // undefined
        console.log(name);     // 멍멍이
        // console.log(ani.name); // 에러
        // --------------------------------------------------------------
        // 안전책
        var Animal = function(name){
            if(!(this instanceof Animal)){
                return new Animal(name);
            }
            this.name = name;
            this.toString = function(){
                return 'Animal:' + this.name;
            };
        };
        var ani2 = Animal('멍멍이2');
        console.log(ani2);      // Object { name: "멍멍이2", toString: toString() }
        console.log(name);      // 멍멍이
        console.log(ani2.name); // 멍멍이2
        // --------------------------------------------------------------
    </script>
</body>
</html>